
<div class="od-projects">
    
	<h1 class="od-title">{{ vm.project_title }}</h1>

	<div layout="row" layout-align="space-between center">
		<a class="md-button" href="#/projekter"><i class="material-icons">arrow_back</i> Tilbage til projekter</a>
		
		<div  class="od-search" layout="row">
			<span flex></span>
			<form name="doSearch" ng-submit="vm.getSearchresults(searchText);">
				<!-- <md-input-container> -->
					<i class="material-icons">search</i>
					<md-autocomplete
							required
							md-input-name="autocomplete"
							md-selected-item="searchQuery"
							md-search-text="searchText"
							md-items="r in vm.getAutoSuggestions(searchText)"
							md-item-text="r.name"
							md-floating-label="Søg">
						<md-item-template>
							<span id="searchInput" md-highlight-text="searchText" ng-click="vm.gotoPath(r.nodeRef);">{{r.name}}</span>
						</md-item-template>
						<div ng-messages="autocompleteForm.autocomplete.$error">
							<div ng-message="required">Dette felt skal udfyldes</div>
						</div>
					</md-autocomplete>
				<!-- </md-input-container> -->
					<!-- <md-button type="submit" class="md-primary">Søg</md-button> -->
			</form>
		</div>
		<!--
		<button class="md-button" ng-click="vm.deleteSite(vm.project)"><i class="material-icons">delete</i> Slet projekt</button>
		<button class="md-button" ng-click="vm.renameSiteDialog($event)"> Omdøb projekt</button>
		-->

		<!-- <button class="md-button" ng-click="vm.copyNodeRefs(vm.source, vm.dest, vm.parentId)"> Afprøv flyt</button> -->

	</div>

	<div layout-gt-sm="row">
		<md-card flex-gt-sm="66">
			<md-card-content>
				<h2 class="od-title-icon"><i class="material-icons">library_books</i>Dokumenter</h2>
			
				<breadcrumb paths="vm.paths"></breadcrumb>
				
				<md-list>
					<md-list-item ng-repeat="content in contents">
						<md-divider></md-divider>
						
						<div ng-show="content.contentType === 'cmis:document'" layout="row" layout-align="space-between center" flex>
							
							<a class="od-filebrowser-link" ng-href="#/dokument/{{content.shortRef}}">
								<i class="material-icons" ng-show="content.contentType === 'cmis:document'">insert_drive_file</i>
								{{content.name}}
							</a>

							<md-menu>
								<md-button class="md-icon-button" ng-click="vm.openMenu($mdOpenMenu, $event)">
									<md-icon md-menu-origin>arrow_drop_down</md-icon>
								</md-button>
	
								<md-menu-content width="6">
									<md-menu-item>
										<md-button ng-click="vm.downloadDocument(content.nodeRef, content.name)">
											<md-icon md-menu-align-target>get_app</md-icon>
											Download
										</md-button>
									</md-menu-item>
	
									<md-menu-item>
										<md-button ng-click="vm.previewDocument(content.nodeRef)">
											<md-icon md-menu-align-target>search</md-icon>
											Preview
										</md-button>
									</md-menu-item>
	
									<md-menu-item>
										<md-button ng-click="vm.deleteFileDialog($event, content.nodeRef)">
											<md-icon md-menu-align-target>remove_circle_outline</md-icon>
											Slet
										</md-button>
									</md-menu-item>
	
									<md-menu-item>
										<md-button ng-click="vm.renameDocumentDialog($event, content.nodeRef)">
											<md-icon md-menu-align-target>create</md-icon>
											Omdøb
										</md-button>
									</md-menu-item>

									
									<md-menu-item>
										<md-button ng-click="vm.copyFileDialog($event, content.nodeRef, content.parentNodeRef)">
											<md-icon md-menu-align-target>content_copy</md-icon>
											Kopiér
										</md-button>
									</md-menu-item>
									
									<md-menu-item>
										<md-button ng-click="vm.moveFileDialog($event, content.nodeRef, content.parentNodeRef)">
											<md-icon md-menu-align-target>compare_arrows</md-icon>
											Flyt
										</md-button>
									</md-menu-item>


									<md-menu-item>
										<md-button ng-click="vm.reviewDocumentsDialog($event, content.nodeRef)">
											<md-icon md-menu-align-target>playlist_add_check</md-icon>
											Send til godkendelse
										</md-button>
									</md-menu-item>


								</md-menu-content>
							</md-menu>

						</div>

						<div ng-show="content.contentType === 'cmis:folder'" layout="row" layout-align="space-between center" flex>
							
							<a class="od-filebrowser-link" ng-href="#/projekter/{{vm.project}}{{vm.path}}/{{content.name}}">
								<i class="material-icons" ng-show="content.contentType === 'cmis:folder'">folder</i>
								{{content.name}}
							</a>

							<md-menu>
								<md-button class="md-icon-button" ng-click="vm.openMenu($mdOpenMenu, $event)">
									<md-icon md-menu-origin>arrow_drop_down</md-icon>
								</md-button>

								<md-menu-content width="6">
									<md-menu-item>
										<md-button ng-click="vm.deleteFoldereDialog($event, content.nodeRef)">
											<md-icon md-menu-align-target>remove_circle_outline</md-icon>
											Slet
										</md-button>
									</md-menu-item>
	
									<!-- <md-menu-item>
									<md-button ng-click="">
										<md-icon md-menu-align-target>create</md-icon>
										Rename
									</md-button>
									</md-menu-item> -->
								</md-menu-content>
							</md-menu>
						</div>
					</md-list-item>
				</md-list>

				<p ng-show="contents.length === 0">
					Denne mappe er tom
				</p>
			</md-card-content>
			
			
			<div layout="row" layout-align="start center">
				<button class="md-button" ng-click="vm.newFolderDialog($event)"><i class="material-icons">add</i> Ny mappe</button>
				<button class="md-button" ng-click="vm.uploadDocumentsDialog($event)"><i class="material-icons">file_upload</i> Upload dokumenter</button>
			</div>
			
		</md-card>


		<md-card flex-gt-sm="33">
			<md-card-content>
				<h2 class="od-title-icon"><i class="material-icons">group</i>Medlemmer</h2>
				
				<table class="od-members">
				  <tr ng-repeat="member in members">
				    <td>{{ member.authority.firstName }} {{ member.authority.lastName }}</td>
				    <td>{{ member.role }}</td>
				    <td>
							<md-menu>
							<md-button class="md-icon-button" ng-click="vm.openMenu($mdOpenMenu, $event)">
								<md-icon md-menu-origin>arrow_drop_down</md-icon>

							</md-button>
							<md-menu-content>
								<md-menu-item>
									<md-button ng-click="vm.uploadSbsysDialog($event)"><i class="material-icons">unarchive</i> Gem projekt</md-button>
								</md-menu-item>
								<md-menu-item>
									<md-button ng-click="vm.loadSbsysDialog($event)"><i class="material-icons">archive</i> Hent dokumenter</md-button>
								</md-menu-item>
							</md-menu-content>
						</md-menu>
					</div>

                    <div layout="column">
                        <md-menu ng-if="vm.project.type != vm.strings.templateProject && vm.canEdit">
                            <md-button ng-click="$mdMenu.open($event)" class="md-raised" aria-label="SBSYS">
                                <i class="material-icons">folder_open</i>
                                <span style="margin-left: 10px; margin-right: 20px;">Opret nyt dokument</span>
                            </md-button>
                            <md-menu-content>
                                        <md-menu-item ng-repeat="template in templateDocuments">
                                        <md-button ng-click="vm.createDocumentFromTemplate(template.nodeRef)"><i class="material-icons">unarchive</i> {{template.name}}</md-button>
                                        </md-menu-item>
                            </md-menu-content>
                        </md-menu>
                    </div>





                </div>
            </md-card-content>
        </md-card>

        

        <div flex-gt-sm="25" ng-if="vm.project.type === vm.strings.project || vm.project.type === vm.strings.templateProject ">
            
            <div>
                <h3 ng-click="vm.showProjDetails = !vm.showProjDetails"
                    class="pd-group-toggle white"
                    ng-class="vm.showProjDetails ? 'open' : 'closed'"
                    layout="row"
                    style="margin: 8px;">
                    <span><i class="material-icons" style="vertical-align: bottom; margin-right: 10px;">info_outline</i>Detaljer</span>
                    <span flex></span>
                    <i id="rotateArrow" class="material-icons">keyboard_arrow_down</i>
                </h3>
                <md-card ng-show="vm.showProjDetails">
                    <md-card-content>
                        <div layout="row" layout-align="space-between">
                            <dl style="margin-bottom: 0;">
                                <dt>Beskrivelse</dt>
                                <dd ng-if="vm.hasDescription">{{ vm.project.description }}</dd>
								<dd ng-if="!vm.hasDescription"><i>Ingen beskrivelse</i></dd>
                            </dl>
                            <md-button ng-if="vm.isManager" ng-click="vm.editSiteDialog($event)" class="md-icon-button md-raised">
                                <i class="material-icons">edit</i>
                            </md-button>
                        </div>
                        <div layout="row">
                            <dl>
                                <dt>Oprettet af</dt>
                                <dd>{{ vm.project.creator.fullName }} <br><span class="muted">{{ vm.project.created | date }}</span></dd>
                            </dl>
                        </div>
                    </md-card-content>
                </md-card>
            </div>
            
            <md-card>
                <md-card-content>
                    <h3 class="od-title-icon"><i class="material-icons">group</i> Medlemmer</h3>
                    <md-list class="od-members">
                        <md-list-item ng-repeat="member in members">
                            <div flex="50" flex-gt-lg="60">
                                {{ member.authority.firstName }} {{ member.authority.lastName }}
                            </div>
                            <div flex="30">
                                {{ role_mapping[member.role] }}
                            </div>
                            <div flex="20" flex-gt-lg="10" style="text-align: right;">
                                <md-menu ng-if="vm.isManager">
                                    <md-button class="md-icon-button" ng-click="$mdMenu.open()">
                                        <md-icon md-menu-origin>more_vert</md-icon>
                                    </md-button>
    
                                    <md-menu-content width="6">
                                        <md-menu-item>
                                            <md-button ng-click="vm.updateMemberRoleDialog($event, member.authority, member.role)">
                                                <md-icon md-menu-align-target>create</md-icon>
                                                Redigér medlem
                                            </md-button>
                                        </md-menu-item>
    
                                        <md-menu-item>
                                            <md-button
                                                    ng-click="vm.deleteMemberDialog($event, vm.project.shortName, member.authority.userName);">
                                                <md-icon md-menu-align-target>remove_circle_outline</md-icon>
                                                Slet
                                            </md-button>
                                        </md-menu-item>
                                    </md-menu-content>
                                </md-menu>
                            </div>
                            <md-divider></md-divider>
                        </md-list-item>
                    </md-list>
    
                    <div layout="row" layout-align="start center" class="btnAlign">
                        <md-button ng-if="vm.isManager" class="md-raised" ng-click="vm.newMember($event)">
                            <i class="material-icons">add</i>
                            Tilføj medlem&nbsp;&nbsp;
                        </md-button>
                    </div>
                </md-card-content>
            </md-card>
        </div>
        
        <div flex-gt-sm="25" ng-if="vm.project.type === 'PD-Project'">
            <div ng-include="'app/src/sites/modules/pd_sites/view/groups_overview.html'"></div>
        </div>
    </div>
</div>
<div class="od-projects" ng-if="vm.isMember != null && !vm.isMember && vm.project.visibility == 'PRIVATE'">
    Du har ikke adgang til dette projekt.
</div>
